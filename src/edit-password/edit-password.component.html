<div class="change-password-container">
  <p-card header="Forgot Password" styleClass="change-password-card">
    <form [formGroup]="editPasswordForm" (ngSubmit)="onSubmit()">
      <div class="form-field">
        <label for="currentPassword">Current Password</label>
        <input
          id="currentPassword"
          type="password"
          pInputText
          formControlName="currentPassword"
          placeholder="Enter your current password"
          [class.ng-invalid]="isFieldInvalid('currentPassword')"
        />
        <small
          class="error-message"
          *ngIf="isFieldInvalid('currentPassword')"
        >
          {{ getFieldError('currentPassword') }}
        </small>
      </div>

      <div class="form-field">
        <label for="newPassword">New Password</label>
        <input
          id="newPassword"
          type="password"
          pInputText
          formControlName="newPassword"
          placeholder="Enter new password"
          [class.ng-invalid]="isFieldInvalid('newPassword')"
        />
        <small
          class="error-message"
          *ngIf="isFieldInvalid('newPassword')"
        >
          {{ getFieldError('newPassword') }}
        </small>
      </div>

      <div class="form-field">
        <label for="confirmPassword">Confirm Password</label>
        <input
          id="confirmPassword"
          type="password"
          pInputText
          formControlName="confirmPassword"
          placeholder="Confirm new password"
          [class.ng-invalid]="isFieldInvalid('confirmPassword') || editPasswordForm.errors?.['passwordMismatch'] && editPasswordForm.get('confirmPassword')?.touched"
        />
        <small
          class="error-message"
          *ngIf="isFieldInvalid('confirmPassword') || editPasswordForm.errors?.['passwordMismatch'] && editPasswordForm.get('confirmPassword')?.touched"
        >
          {{ getConfirmPasswordError() }}
        </small>
      </div>

      <div class="form-actions">
        <p-button
          type="submit"
          label="Change Password"
          [disabled]="editPasswordForm.invalid || isLoading"
          [loading]="isLoading"
          styleClass="primary-button"
        ></p-button>
        <p-button
          type="button"
          label="Cancel"
          severity="secondary"
          (onClick)="onCancel()"
          styleClass="secondary-button"
        ></p-button>
      </div>

      <p-messages
        *ngIf="errorMessage || successMessage"
        [value]="getMessages()"
        styleClass="form-messages"
      ></p-messages>
    </form>
  </p-card>
</div>