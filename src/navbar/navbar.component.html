<div class="card">
  <p-menubar [model]="items">
   
    <!-- Menu Items Template -->
    <ng-template #item let-item let-root="root">
      <a pRipple class="flex items-center p-menubar-item-link">
        <i *ngIf="item.icon" [class]="item.icon + ' p-menuitem-icon'"></i>
        <span>{{ item.label }}</span>
        <p-badge 
          *ngIf="item.badge" 
          [ngClass]="{ 'ml-auto': !root, 'ml-2': root }" 
          [value]="item.badge" 
        />
        <span 
          *ngIf="item.shortcut" 
          class="ml-auto border border-surface rounded bg-emphasis text-muted-color text-xs p-1"
        >
          {{ item.shortcut }}
        </span>
        <i 
          *ngIf="item.items" 
          [ngClass]="['ml-auto pi', root ? 'pi-angle-down' : 'pi-angle-right']"
        ></i>
      </a>
    </ng-template>

    <!-- End Section - Auth/User Menu -->
    <ng-template #end>
      <!-- Not Logged In State -->
      <div class="auth-section logged-out" *ngIf="!isLoggedIn">
        <button 
          pButton 
          label="Login" 
          class="p-button-sm p-button-outlined" 
          (click)="auth()"
          aria-label="Login to your account"
        >Login
        </button>
      </div>

      <!-- Logged In State -->
      <div class="auth-section logged-in" *ngIf="isLoggedIn">
        <div class="user-menu">
          <p-avatar 
            [label]="userInitial" 
            shape="circle" 
            size="normal"
            (click)="toggleUserDropdown = !toggleUserDropdown"
            [attr.aria-expanded]="toggleUserDropdown"
            [attr.aria-haspopup]="true"
            aria-label="User menu"
            tabindex="0"
            (keydown.enter)="toggleUserDropdown = !toggleUserDropdown"
            (keydown.space)="toggleUserDropdown = !toggleUserDropdown"
          ></p-avatar>
          
          <!-- User Dropdown Menu -->
          <div 
            class="user-dropdown" 
            [class.show]="toggleUserDropdown"
            *ngIf="toggleUserDropdown"
            role="menu"
            aria-label="User options"
          >
            <ul class="dropdown-menu">
              <li role="none">
                <a 
                  role="menuitem" 
                  tabindex="0"
                  (click)="onEditPassword()"
                  (keydown.enter)="onEditPassword()"
                  aria-label="Edit password"
                >
                  <i class="pi pi-key mr-2"></i>
                  Edit Password
                </a>
              </li>
              <li role="none">
                <a 
                  role="menuitem" 
                  tabindex="0"
                  (click)="onUpdateProfile()"
                  
                  aria-label="Update profile"
                >
                  <i class="pi pi-user-edit mr-2"></i>
                  Update Profile
                </a>
              </li>
              <li role="none">
                <button 
                  pButton 
                  label="Logout" 
                  class="p-button-sm p-button-danger w-full danger" 
                  (click)="onLogout()"
                  role="menuitem"
                  aria-label="Logout from your account"
                >
                  <i class="pi pi-sign-out mr-2"></i>
                  Logout
                </button>
              </li>
              <li role="none">
                <button 
                  pButton 
                  label="Delete Profile" 
                  class="p-button-sm p-button-danger w-full danger" 
                  (click)="onDelete()"
                  role="menuitem"
                  aria-label="Logout from your account"
                >
                  <i class="pi pi-sign-out mr-2"></i>
                  Delete Profile
                </button>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </ng-template>
  </p-menubar>
</div>